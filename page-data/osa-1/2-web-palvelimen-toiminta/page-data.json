{"componentChunkName":"component---src-templates-course-content-template-js","path":"/osa-1/2-web-palvelimen-toiminta","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"Oppimistavoitteet"},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Tunnet asiakas-palvelin -mallin."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Tiedät pääpiirteittäin miten web-palvelimet ja web-selaimet toimivat."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Osaat toteuttaa yksinkertaisen palvelimen ja selaimen Java-kielellä."}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tässä luvussa tarkastellaan web-palvelinten ja selainten toimintaa. Palvelimet noudattavat tyypillisesti asiakas-palvelin -mallia, ja web-palvelimet ja selaimet keskustelevat HTTP-protokollaa noudattaen. Tämän lisäksi tarkastellaan Javan tarjoamia välineitä palvelinyhteyden muodostamiseen sekä palvelimen toteuttamiseen."}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Asiakas-palvelin malli"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Asiakas-palvelin -mallissa "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"(Client-Server model)"}]},{"type":"text","value":" asiakkaat käyttävät palvelimen tarjoamia palveluja. Kommunikointi asiakkaan ja palvelimen välillä tapahtuu usein verkon yli siten, että selain ja palvelin sijaitsevat erillisissä fyysisissä sijainneissa (eri tietokoneilla). Palvelin tarjoaa yhden tai useamman palvelun, joita käyttäjä käyttää selaimen kautta."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Käytännössä selain näyttää käyttöliittymän ohjelmiston käyttäjälle. Selaimen käyttäjän ei tarvitse tietää, että kaikki käytetty tieto ei ole hänen koneella. Käyttäjän tehdessä toiminnon selain pyytää tarpeen vaatiessa palvelimelta käyttäjän tarpeeseen liittyvää lisätietoa. Tyypillistä mallille on se, että palvelin tarjoaa vain asiakkaan pyytämät tiedot ja liikkuvan tiedon määrä pidetään vähäisenä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Asiakas-palvelin -malli mahdollistaa hajautetut ohjelmistot: selainta käyttävät loppukäyttäjät voivat sijaita eri puolilla maapalloa palvelimen sijaitessa tietyssä paikassa."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"58a6d3ce-9681-5546-af51-c4dc79d079ff"},"children":[]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Yhteyden muodostaminen palvelimelle Java-maailmassa"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ohjelmoijan näkökulmasta porttia voi ajatella tiedostona. Tiedostoon voi kirjoittaa ja siellä olevaa tietoa voi lukea. Kirjoitettava ja luettava tieto ei kuitenkaan toiseen koneeseen yhteyttä ottaessa tule tiedostosta, vaan yhteyden toisessa päässä toimivasta ohjelmasta. Tarkastellaan seuraavaksi yhteyden muodostamista palvelimelle Java-kielellä."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Java-maailmassa yhteys toiselle koneelle muodostetaan "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html","target":"_blank"},"children":[{"type":"text","value":"Socket"}]},{"type":"text","value":"-luokan avulla. Kun yhteys on muodostettu, toiselle koneelle lähetettävä viesti kirjoitetaan socketin tarjoamaan "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/8/docs/api/java/io/OutputStream.html","target":"_blank"},"children":[{"type":"text","value":"OutputStream"}]},{"type":"text","value":"-rajapintaan. Tämän jälkeen luetaan vastaus socketin tarjoaman "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html","target":"_blank"},"children":[{"type":"text","value":"InputStream"}]},{"type":"text","value":"-rajapinnan kautta."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" osoite "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"www.helsinki.fi\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"int"}]},{"type":"text","value":" portti "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"80"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// muodosta yhteys"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Socket"}]},{"type":"text","value":" socket "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Socket"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"osoite"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" portti"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// lähetä viesti palvelimelle"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"text","value":" kirjoittaja "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getOutputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nkirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"GET / HTTP/1.1\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nkirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"Host: \""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"+"}]},{"type":"text","value":" osoite"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nkirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nkirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"flush"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// lue vastaus palvelimelta"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"text","value":" lukija "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getInputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"while"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"lukija"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"hasNextLine"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"System"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"out"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"println"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"lukija"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"nextLine"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yllä oleva ohjelma ottaa yhteyden etsii www.helsinki.fi -osoitteeseen liittyvän palvelimen, ottaa yhteyden palvelimen porttiin 80, ja lähettää palvelimelle seuraavan viestin:"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"GET / HTTP/1.1\nHost: www.helsinki.fi\n\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tämän jälkeen ohjelma tulostaa palvelimelta saatavan vastauksen."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Lisää verkkoliikenteen käsittelystä löytyy mm. "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/tutorial/networking/sockets/","target":"_blank"},"children":[{"type":"text","value":"tästä oppaasta"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"text-box","properties":{"variant":"hint","name":"Ohjelmointitehtävien tekeminen"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tästä eteenpäin materiaalissa on myös ohjelmointitehtäviä. Ohjelmointitehtävät tehdään NetBeans with TMC -järjestelmässä, jonka käyttöä on harjoiteltu esitietovaatimuksena olevilla kursseilla."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Mikäli et ole aiemmin käyttänyt NetBeans with TMC -järjestelmää, tutustu sen käyttöön osoitteessa "},{"type":"element","tagName":"a","properties":{"href":"https://materiaalit.github.io/tmc-asennus/netbeans/","target":"_blank"},"children":[{"type":"text","value":"https://materiaalit.github.io/tmc-asennus/netbeans/"}]},{"type":"text","value":" olevia ohjeita noudattaen. Toisin kuin ohjeissa, kurssiksi tulee valita \"Web-palvelinohjelmointi Java, Syksy 2020\" (löytyy organisaatiosta \"MOOC\")."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toisin kuin aiemmilla ohjelmointikursseilla, monissa tehtävistä ei ole automaattisia testejä. Yritä saada tehtävä tehtyä ennen sen palauttamista."}]}]},{"type":"element","tagName":"programming-exercise","properties":{"name":"Hello Browser!","tmcname":"osa01-Osa01_01.HelloBrowser"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toteuta tehtäväpohjassa olevan "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"HelloBrowser"}]},{"type":"text","value":"-luokan main-metodiin ohjelma, joka kysyy käyttäjältä sivun osoitetta, tekee syötetyn sivun juureen (\"/\") pyynnön, ja tulostaa käyttäjälle vastauksen."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Alla on esimerkkituloste, missä käyttäjän syöte on annettu punaisella."}]},{"type":"element","tagName":"sample-output","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"================\nTHE INTERNETS!\n================\nWhere to? "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"www.mooc.fi"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"==========\nRESPONSE\n==========\nHTTP/1.1 301 Moved Permanently\n// ... muita otsakkeita"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"<html>\n<head><title>301 Moved Permanently</title></head>\n<body bgcolor=\"white\">\n<center><h1>301 Moved Permanently</h1></center>\n<hr><center>CloudFront</center>\n</body>\n</html>"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos haettua osoitetta ei ole olemassa, ohjelman tulee heittää poikkeus."}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Palvelimen toiminta Java-kielellä"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Tarkastellaan seuraavaksi palvelimen toimintaa Java-kielellä."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Palvelimen toiminta muistuttaa huomattavasti yllä kuvattua yhteyden muodostamista. Toisin kuin yhteyttä toiseen koneeseen muodostaessa, palvelinta toteutettaessa luodaan "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/8/docs/api/java/net/ServerSocket.html","target":"_blank"},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"text","value":"-olio, joka kuuntelee tiettyä koneessa olevaa porttia. Kun toinen kone ottaa yhteyden palvelimeen, saadaan käyttöön Socket-olio, joka tarjoaa mahdollisuuden lukemiseen ja kirjoittamiseen."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Web-palvelin lukee tyypillisesti ensin pyynnön, jonka jälkeen pyyntöön kirjoitetaan vastaus. Alla on esimerkki yksinkertaisen palvelimen toiminnasta — palvelin on toiminnassa vain yhden pyynnön ajan."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// odotetaan pyyntöä porttiin 8080"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"text","value":" server "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Socket"}]},{"type":"text","value":" socket "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" server"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"accept"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// luetaan pyyntö"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"text","value":" lukija "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getInputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// ..."}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// kirjoitetaan vastaus"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"text","value":" kirjoittaja "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getOutputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// ..."}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// suljetaan resurssit"}]},{"type":"text","value":"\nlukija"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nkirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nsocket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\nserver"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"text","value":"-olion "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"accept"}]},{"type":"text","value":"-metodi on blokkaava. Tämä tarkoittaa sitä, että "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"accept"}]},{"type":"text","value":"-metodia kutsuttaessa ohjelman suoritus jää odottamaan kunnes palvelimeen otetaan yhteys. Kun yhteys on muodostettu, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"accept"}]},{"type":"text","value":"-metodi palauttaa "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Socket"}]},{"type":"text","value":"-olion, jota käytetään palvelimen ja yhteyden ottaneen koneen väliseen kommunikointiin."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kokeile ylläolevaa ohjelmaa omalla koneellasi. Ohjelma käynnistää palvelimen, joka kuuntelee pyyntöä paikallisen koneen porttiin "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":". Voit tehdä HTTP-muotoisen pyynnön porttiin 8080 selaimella kirjoittamalla selaimeen osoitteeksi "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"http://localhost:8080"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"text-box","properties":{"variant":"hint","name":"Tietokoneen portit"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos kokeilet käynnistää palvelimen koneellasi, saatat törmätä virheviestiin. Tähän on useita mahdollisia syitä: (1) koneellasi oleva palomuuri- tai tietoturvaohjelmisto ei salli portin avaamista, (2) portti on jo käytössä (koneellasi oleva ohjelma — esimerkiksi palvelin — käyttää porttia 80), tai käyttäjätunnuksellasi ei ole oikeuksia portin avaamiseen."}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Tietokoneella on käytössä portit 0-65535, joista \"normaali\" käyttäjä saa tyypillisesti avata vain suurempia kuin 1024 olevia. Lue lisää porteista "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Portti_(tietoliikenne)","target":"_blank"},"children":[{"type":"text","value":"Wikipediasta"}]},{"type":"text","value":"."}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Palvelin halutaan tyypillisesti toteuttaa niin, että se kuuntelee ja käsittelee pyyntöjä jatkuvasti. Tämä onnistuu toistolauseen avulla."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"java"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-java"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// luodaan palvelin porttiin 8080"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"text","value":" server "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"ServerSocket"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"while"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","boolean"]},"children":[{"type":"text","value":"true"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// odotetaan pyyntöä"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Socket"}]},{"type":"text","value":" socket "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" server"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"accept"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// luetaan pyyntö"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"text","value":" lukija "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"Scanner"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getInputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// ..."}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// kirjoitetaan vastaus"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"text","value":" kirjoittaja "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"new"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","class-name"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"getOutputStream"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// ..."}]},{"type":"text","value":"\n\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// vapautetaan resurssit"}]},{"type":"text","value":"\n    lukija"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    kirjoittaja"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    socket"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"close"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Web-palvelimet käsittelevät useampia pyyntöjä lähes samanaikaisesti, sillä palvelinohjelmistot ovat tyypillisesti säikeistettyjä. Tällöin jokainen pyyntö käsitellään erillisessä säikeessä, joka luo pyyntöön vastauksen ja palauttaa sen käyttäjille. Javassa säikeille löytyy oma "},{"type":"element","tagName":"a","properties":{"href":"https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html","target":"_blank"},"children":[{"type":"text","value":"Thread"}]},{"type":"text","value":"-luokka. Emme kuitenkaan tällä kurssilla perehdy säikeiden käyttöön sen tarkemmin — mm. tätä varten löytyy kurssi Käyttöjärjestelmät (TKT-20003)."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"programming-exercise","properties":{"name":"Hello Server!","tmcname":"osa01-Osa01_02.HelloServer"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toteuta web-palvelin, joka kuuntelee pyyntöjä porttiin 8080."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos pyydetty polku on "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/quit"}]},{"type":"text","value":", tulee palvelin sammuttaa."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Muulloin, minkä tahansa pyynnön vastaukseen tulee palauttaa HTTP-statuskoodi 200 sekä tehtäväpohjassa olevan "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"index.html"}]},{"type":"text","value":"-sivun sisältö."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Huom! Älä missään nimessä käytä kutsua "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"System.exit"}]},{"type":"text","value":" palvelimen sammuttamiseen nyt tai myöhemmissä tehtävissä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Huom2! Kun kirjoitat vastauksen "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"PrintWriter"}]},{"type":"text","value":"-olion avulla, kutsu olion "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"flush"}]},{"type":"text","value":"-metodia ennen yhteyden sulkemista. Tällöin vältät tilanteen, missä yhteys suljetaan ennen kuin kaikki tieto on todellisuudessa kirjoitettu vastaukseen asti."}]}]},{"type":"element","tagName":"programming-exercise","properties":{"name":"Hello Redirect Loop!","tmcname":"osa01-Osa01_03.HelloRedirectLoop"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toteuta web-palvelin, joka kuuntelee pyyntöjä porttiin 8080."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos pyydetty polku on "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/quit"}]},{"type":"text","value":", tulee palvelin sammuttaa."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Muulloin, minkä tahansa pyynnön vastaukseen kirjoitetaan resurssin siirtymisestä kertova (302-alkuinen) HTTP-statuskoodi sekä palvelimen osoite, eli "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"http://localhost:8080"}]},{"type":"text","value":" — tämä tulee tehdä HTTP-protokollan odottamassa muodossa eli:"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"HTTP/1.1 302 Found\nLocation: http://localhost:8080\n\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ota samalla selvää kuinka monta pyyntöä selaimesi tekee palvelimelle, ennen kuin se ymmärtää että jotain on vialla."}]},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 430px; margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 54.347826086956516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABXUlEQVQoz5VS246CUAzk///LxH1So4hkCYJcBBEQ5Koks23jUZYYs/swaU/pGU5nqmXWEllgIzmfsd3HSLMM0fEIc2dguzVwOBwQBAEyqt9uN/R9/xFaHlNzEssFLzojz3OkaYo4jgVJkiCnb2VRoK5rQvWI76E1HTHTn7u2Rde1aJoGreSdgHMG1z8RvQip8XQ64Xq9Pi+qqKBI/wKNWWezGWzbxv1+l7+Myf4LeSELz9oxIQuvxFf5uMbgvnGvgryQtQsCH47jigGe5wmiOIJPMQxDcZkjmxVFERzXpUe48Kl+DAP4PsNHVVXQehLecx2s1zpcx8FisYBpmjAMA1/zOXRaHcv6xmazESLOl6sVdF2nnh2c/V5yrhW0CTJyUzfiaC3xZYhyjkeRER8yDMNA5+E5tooyMl8sLhdhZ7CW+ePM+YXysix/mTU1jh/yNGVq+3j/3u3itH+6Zj/ewUfJNs4u+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/522a8241dbcdfb0fc80945b7e937eac9/a0b58/redirectloop.webp 230w","/static/522a8241dbcdfb0fc80945b7e937eac9/866c5/redirectloop.webp 430w"],"sizes":["(max-width:","430px)","100vw,","430px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/522a8241dbcdfb0fc80945b7e937eac9/81c8e/redirectloop.png 230w","/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png 430w"],"sizes":["(max-width:","430px)","100vw,","430px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png","alt":"redirectloop","title":"redirectloop","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"element","tagName":"h2","properties":{},"children":[]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"text","value":"Käsittelimme tässä luvussa selaimen ja palvelimen toimintaa sekä toteutimme yksinkertaisen selaimen ja palvelimen. Jatkossa oletamme, että käytössämme on selain (kurssin esimerkeissä oletetaan "},{"type":"element","tagName":"a","properties":{"href":"https://www.google.com/chrome/","target":"_blank"},"children":[{"type":"text","value":"Google Chrome"}]},{"type":"text","value":"-selaimen käyttö). Tämän lisäksi jatkossa toteutettavat sovelluksemme hyödyntävät valmiita palvelimia kuten "},{"type":"element","tagName":"a","properties":{"href":"https://tomcat.apache.org","target":"_blank"},"children":[{"type":"text","value":"Apache Tomcat"}]},{"type":"text","value":" ja "},{"type":"element","tagName":"a","properties":{"href":"https://www.eclipse.org/jetty/","target":"_blank"},"children":[{"type":"text","value":"Eclipse Jetty"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kun käytössämme on valmiit selaimet ja palvelimet, voimme keskittyä web-sovelluksen logiikan toteuttamiseen."}]}]},"html":"<div><text-box variant='learningObjectives' name='Oppimistavoitteet'><ul>\n<li>Tunnet asiakas-palvelin -mallin.</li>\n<li>Tiedät pääpiirteittäin miten web-palvelimet ja web-selaimet toimivat.</li>\n<li>Osaat toteuttaa yksinkertaisen palvelimen ja selaimen Java-kielellä.</li>\n</ul></text-box><p>Tässä luvussa tarkastellaan web-palvelinten ja selainten toimintaa. Palvelimet noudattavat tyypillisesti asiakas-palvelin -mallia, ja web-palvelimet ja selaimet keskustelevat HTTP-protokollaa noudattaen. Tämän lisäksi tarkastellaan Javan tarjoamia välineitä palvelinyhteyden muodostamiseen sekä palvelimen toteuttamiseen.</p><h2>Asiakas-palvelin malli</h2><p>Asiakas-palvelin -mallissa <em>(Client-Server model)</em> asiakkaat käyttävät palvelimen tarjoamia palveluja. Kommunikointi asiakkaan ja palvelimen välillä tapahtuu usein verkon yli siten, että selain ja palvelin sijaitsevat erillisissä fyysisissä sijainneissa (eri tietokoneilla). Palvelin tarjoaa yhden tai useamman palvelun, joita käyttäjä käyttää selaimen kautta.</p><p>Käytännössä selain näyttää käyttöliittymän ohjelmiston käyttäjälle. Selaimen käyttäjän ei tarvitse tietää, että kaikki käytetty tieto ei ole hänen koneella. Käyttäjän tehdessä toiminnon selain pyytää tarpeen vaatiessa palvelimelta käyttäjän tarpeeseen liittyvää lisätietoa. Tyypillistä mallille on se, että palvelin tarjoaa vain asiakkaan pyytämät tiedot ja liikkuvan tiedon määrä pidetään vähäisenä.</p><p>Asiakas-palvelin -malli mahdollistaa hajautetut ohjelmistot: selainta käyttävät loppukäyttäjät voivat sijaita eri puolilla maapalloa palvelimen sijaitessa tietyssä paikassa.</p><div><quiz id=\"58a6d3ce-9681-5546-af51-c4dc79d079ff\"></quiz></div><h3>Yhteyden muodostaminen palvelimelle Java-maailmassa</h3><p>Ohjelmoijan näkökulmasta porttia voi ajatella tiedostona. Tiedostoon voi kirjoittaa ja siellä olevaa tietoa voi lukea. Kirjoitettava ja luettava tieto ei kuitenkaan toiseen koneeseen yhteyttä ottaessa tule tiedostosta, vaan yhteyden toisessa päässä toimivasta ohjelmasta. Tarkastellaan seuraavaksi yhteyden muodostamista palvelimelle Java-kielellä.</p><div>Java-maailmassa yhteys toiselle koneelle muodostetaan <a href=\"https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html\" target=\"_blank\">Socket</a>-luokan avulla. Kun yhteys on muodostettu, toiselle koneelle lähetettävä viesti kirjoitetaan socketin tarjoamaan <a href=\"https://docs.oracle.com/javase/8/docs/api/java/io/OutputStream.html\" target=\"_blank\">OutputStream</a>-rajapintaan. Tämän jälkeen luetaan vastaus socketin tarjoaman <a href=\"https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html\" target=\"_blank\">InputStream</a>-rajapinnan kautta.</div><br/><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">String</span> osoite <span class=\"token operator\">=</span> <span class=\"token string\">\"www.helsinki.fi\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> portti <span class=\"token operator\">=</span> <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// muodosta yhteys</span>\n<span class=\"token class-name\">Socket</span> socket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Socket</span><span class=\"token punctuation\">(</span>osoite<span class=\"token punctuation\">,</span> portti<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// lähetä viesti palvelimelle</span>\n<span class=\"token class-name\">PrintWriter</span> kirjoittaja <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrintWriter</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GET / HTTP/1.1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Host: \"</span> <span class=\"token operator\">+</span> osoite<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// lue vastaus palvelimelta</span>\n<span class=\"token class-name\">Scanner</span> lukija <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>lukija<span class=\"token punctuation\">.</span><span class=\"token function\">hasNextLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>lukija<span class=\"token punctuation\">.</span><span class=\"token function\">nextLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>Yllä oleva ohjelma ottaa yhteyden etsii www.helsinki.fi -osoitteeseen liittyvän palvelimen, ottaa yhteyden palvelimen porttiin 80, ja lähettää palvelimelle seuraavan viestin:</p><pre>\nGET / HTTP/1.1\nHost: www.helsinki.fi\n\n</pre><p>Tämän jälkeen ohjelma tulostaa palvelimelta saatavan vastauksen.</p><div>Lisää verkkoliikenteen käsittelystä löytyy mm. <a href=\"https://docs.oracle.com/javase/tutorial/networking/sockets/\" target=\"_blank\">tästä oppaasta</a>.</div><br/><text-box variant='hint' name='Ohjelmointitehtävien tekeminen'><p>Tästä eteenpäin materiaalissa on myös ohjelmointitehtäviä. Ohjelmointitehtävät tehdään NetBeans with TMC -järjestelmässä, jonka käyttöä on harjoiteltu esitietovaatimuksena olevilla kursseilla.</p><div>Mikäli et ole aiemmin käyttänyt NetBeans with TMC -järjestelmää, tutustu sen käyttöön osoitteessa <a href=\"https://materiaalit.github.io/tmc-asennus/netbeans/\" target=\"_blank\">https://materiaalit.github.io/tmc-asennus/netbeans/</a> olevia ohjeita noudattaen. Toisin kuin ohjeissa, kurssiksi tulee valita \"Web-palvelinohjelmointi Java, Syksy 2020\" (löytyy organisaatiosta \"MOOC\").</div><p>Toisin kuin aiemmilla ohjelmointikursseilla, monissa tehtävistä ei ole automaattisia testejä. Yritä saada tehtävä tehtyä ennen sen palauttamista.</p></text-box><programming-exercise name='Hello Browser!' tmcname='osa01-Osa01_01.HelloBrowser'><p>Toteuta tehtäväpohjassa olevan <code class=\"language-text\">HelloBrowser</code>-luokan main-metodiin ohjelma, joka kysyy käyttäjältä sivun osoitetta, tekee syötetyn sivun juureen (\"/\") pyynnön, ja tulostaa käyttäjälle vastauksen.</p><p>Alla on esimerkkituloste, missä käyttäjän syöte on annettu punaisella.</p><sample-output><p>================\nTHE INTERNETS!\n================\nWhere to? <strong>www.mooc.fi</strong></p><p>==========\nRESPONSE\n==========\nHTTP/1.1 301 Moved Permanently\n// ... muita otsakkeita</p><p>&#x3C;html>\n&#x3C;head>&#x3C;title>301 Moved Permanently&#x3C;/title>&#x3C;/head>\n&#x3C;body bgcolor=\"white\">\n&#x3C;center>&#x3C;h1>301 Moved Permanently&#x3C;/h1>&#x3C;/center>\n&#x3C;hr>&#x3C;center>CloudFront&#x3C;/center>\n&#x3C;/body>\n&#x3C;/html></p></sample-output><p>Jos haettua osoitetta ei ole olemassa, ohjelman tulee heittää poikkeus.</p></programming-exercise><h3>Palvelimen toiminta Java-kielellä</h3><p>Tarkastellaan seuraavaksi palvelimen toimintaa Java-kielellä.</p><div>Palvelimen toiminta muistuttaa huomattavasti yllä kuvattua yhteyden muodostamista. Toisin kuin yhteyttä toiseen koneeseen muodostaessa, palvelinta toteutettaessa luodaan <a href=\"https://docs.oracle.com/javase/8/docs/api/java/net/ServerSocket.html\" target=\"_blank\">ServerSocket</a>-olio, joka kuuntelee tiettyä koneessa olevaa porttia. Kun toinen kone ottaa yhteyden palvelimeen, saadaan käyttöön Socket-olio, joka tarjoaa mahdollisuuden lukemiseen ja kirjoittamiseen.</div><br/><p>Web-palvelin lukee tyypillisesti ensin pyynnön, jonka jälkeen pyyntöön kirjoitetaan vastaus. Alla on esimerkki yksinkertaisen palvelimen toiminnasta — palvelin on toiminnassa vain yhden pyynnön ajan.</p><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// odotetaan pyyntöä porttiin 8080</span>\n<span class=\"token class-name\">ServerSocket</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerSocket</span><span class=\"token punctuation\">(</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Socket</span> socket <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// luetaan pyyntö</span>\n<span class=\"token class-name\">Scanner</span> lukija <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token comment\">// kirjoitetaan vastaus</span>\n<span class=\"token class-name\">PrintWriter</span> kirjoittaja <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrintWriter</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token comment\">// suljetaan resurssit</span>\nlukija<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p><code class=\"language-text\">ServerSocket</code>-olion <code class=\"language-text\">accept</code>-metodi on blokkaava. Tämä tarkoittaa sitä, että <code class=\"language-text\">accept</code>-metodia kutsuttaessa ohjelman suoritus jää odottamaan kunnes palvelimeen otetaan yhteys. Kun yhteys on muodostettu, <code class=\"language-text\">accept</code>-metodi palauttaa <code class=\"language-text\">Socket</code>-olion, jota käytetään palvelimen ja yhteyden ottaneen koneen väliseen kommunikointiin.</p><p>Kokeile ylläolevaa ohjelmaa omalla koneellasi. Ohjelma käynnistää palvelimen, joka kuuntelee pyyntöä paikallisen koneen porttiin <code class=\"language-text\">8080</code>. Voit tehdä HTTP-muotoisen pyynnön porttiin 8080 selaimella kirjoittamalla selaimeen osoitteeksi <code class=\"language-text\">http://localhost:8080</code>.</p><br/><text-box variant='hint' name='Tietokoneen portit'><p>Jos kokeilet käynnistää palvelimen koneellasi, saatat törmätä virheviestiin. Tähän on useita mahdollisia syitä: (1) koneellasi oleva palomuuri- tai tietoturvaohjelmisto ei salli portin avaamista, (2) portti on jo käytössä (koneellasi oleva ohjelma — esimerkiksi palvelin — käyttää porttia 80), tai käyttäjätunnuksellasi ei ole oikeuksia portin avaamiseen.</p><div>Tietokoneella on käytössä portit 0-65535, joista \"normaali\" käyttäjä saa tyypillisesti avata vain suurempia kuin 1024 olevia. Lue lisää porteista <a href=\"https://fi.wikipedia.org/wiki/Portti_(tietoliikenne)\" target=\"_blank\">Wikipediasta</a>.</div></text-box><p>Palvelin halutaan tyypillisesti toteuttaa niin, että se kuuntelee ja käsittelee pyyntöjä jatkuvasti. Tämä onnistuu toistolauseen avulla.</p><div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// luodaan palvelin porttiin 8080</span>\n<span class=\"token class-name\">ServerSocket</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerSocket</span><span class=\"token punctuation\">(</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// odotetaan pyyntöä</span>\n    <span class=\"token class-name\">Socket</span> socket <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// luetaan pyyntö</span>\n    <span class=\"token class-name\">Scanner</span> lukija <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// kirjoitetaan vastaus</span>\n    <span class=\"token class-name\">PrintWriter</span> kirjoittaja <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrintWriter</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token comment\">// vapautetaan resurssit</span>\n    lukija<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    kirjoittaja<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    socket<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><div>Web-palvelimet käsittelevät useampia pyyntöjä lähes samanaikaisesti, sillä palvelinohjelmistot ovat tyypillisesti säikeistettyjä. Tällöin jokainen pyyntö käsitellään erillisessä säikeessä, joka luo pyyntöön vastauksen ja palauttaa sen käyttäjille. Javassa säikeille löytyy oma <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html\" target=\"_blank\">Thread</a>-luokka. Emme kuitenkaan tällä kurssilla perehdy säikeiden käyttöön sen tarkemmin — mm. tätä varten löytyy kurssi Käyttöjärjestelmät (TKT-20003).</div><br/><programming-exercise name='Hello Server!' tmcname='osa01-Osa01_02.HelloServer'><p>Toteuta web-palvelin, joka kuuntelee pyyntöjä porttiin 8080.</p><p>Jos pyydetty polku on <code class=\"language-text\">/quit</code>, tulee palvelin sammuttaa.</p><p>Muulloin, minkä tahansa pyynnön vastaukseen tulee palauttaa HTTP-statuskoodi 200 sekä tehtäväpohjassa olevan <code class=\"language-text\">index.html</code>-sivun sisältö.</p><p>Huom! Älä missään nimessä käytä kutsua <code class=\"language-text\">System.exit</code> palvelimen sammuttamiseen nyt tai myöhemmissä tehtävissä.</p><p>Huom2! Kun kirjoitat vastauksen <code class=\"language-text\">PrintWriter</code>-olion avulla, kutsu olion <code class=\"language-text\">flush</code>-metodia ennen yhteyden sulkemista. Tällöin vältät tilanteen, missä yhteys suljetaan ennen kuin kaikki tieto on todellisuudessa kirjoitettu vastaukseen asti.</p></programming-exercise><programming-exercise name='Hello Redirect Loop!' tmcname='osa01-Osa01_03.HelloRedirectLoop'><p>Toteuta web-palvelin, joka kuuntelee pyyntöjä porttiin 8080.</p><p>Jos pyydetty polku on <code class=\"language-text\">/quit</code>, tulee palvelin sammuttaa.</p><p>Muulloin, minkä tahansa pyynnön vastaukseen kirjoitetaan resurssin siirtymisestä kertova (302-alkuinen) HTTP-statuskoodi sekä palvelimen osoite, eli <code class=\"language-text\">http://localhost:8080</code> — tämä tulee tehdä HTTP-protokollan odottamassa muodossa eli:</p><pre>\nHTTP/1.1 302 Found\nLocation: http://localhost:8080\n\n</pre><p>Ota samalla selvää kuinka monta pyyntöä selaimesi tekee palvelimelle, ennen kuin se ymmärtää että jotain on vialla.</p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 430px; margin-bottom: 1rem;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.347826086956516%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABXUlEQVQoz5VS246CUAzk///LxH1So4hkCYJcBBEQ5Koks23jUZYYs/swaU/pGU5nqmXWEllgIzmfsd3HSLMM0fEIc2dguzVwOBwQBAEyqt9uN/R9/xFaHlNzEssFLzojz3OkaYo4jgVJkiCnb2VRoK5rQvWI76E1HTHTn7u2Rde1aJoGreSdgHMG1z8RvQip8XQ64Xq9Pi+qqKBI/wKNWWezGWzbxv1+l7+Myf4LeSELz9oxIQuvxFf5uMbgvnGvgryQtQsCH47jigGe5wmiOIJPMQxDcZkjmxVFERzXpUe48Kl+DAP4PsNHVVXQehLecx2s1zpcx8FisYBpmjAMA1/zOXRaHcv6xmazESLOl6sVdF2nnh2c/V5yrhW0CTJyUzfiaC3xZYhyjkeRER8yDMNA5+E5tooyMl8sLhdhZ7CW+ePM+YXysix/mTU1jh/yNGVq+3j/3u3itH+6Zj/ewUfJNs4u+AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <picture>\n        <source srcset=\"/static/522a8241dbcdfb0fc80945b7e937eac9/a0b58/redirectloop.webp 230w,\n/static/522a8241dbcdfb0fc80945b7e937eac9/866c5/redirectloop.webp 430w\" sizes=\"(max-width: 430px) 100vw, 430px\" type=\"image/webp\">\n        <source srcset=\"/static/522a8241dbcdfb0fc80945b7e937eac9/81c8e/redirectloop.png 230w,\n/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png 430w\" sizes=\"(max-width: 430px) 100vw, 430px\" type=\"image/png\">\n        <img class=\"gatsby-resp-image-image\" src=\"/static/522a8241dbcdfb0fc80945b7e937eac9/05ed2/redirectloop.png\" alt=\"redirectloop\" title=\"redirectloop\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n      </picture>\n  </a>\n    </span></programming-exercise><h2></h2><div>Käsittelimme tässä luvussa selaimen ja palvelimen toimintaa sekä toteutimme yksinkertaisen selaimen ja palvelimen. Jatkossa oletamme, että käytössämme on selain (kurssin esimerkeissä oletetaan <a href=\"https://www.google.com/chrome/\" target=\"_blank\">Google Chrome</a>-selaimen käyttö). Tämän lisäksi jatkossa toteutettavat sovelluksemme hyödyntävät valmiita palvelimia kuten <a href=\"https://tomcat.apache.org\" target=\"_blank\">Apache Tomcat</a> ja <a href=\"https://www.eclipse.org/jetty/\" target=\"_blank\">Eclipse Jetty</a>.</div><br/><p>Kun käytössämme on valmiit selaimet ja palvelimet, voimme keskittyä web-sovelluksen logiikan toteuttamiseen.</p></div>","frontmatter":{"path":"/osa-1/2-web-palvelimen-toiminta","title":"Web-palvelimen toiminta"}},"allPages":{"edges":[{"node":{"id":"3283b622-bc08-5a19-9f02-6e3db5b31a9e","frontmatter":{"path":"/arvostelu-ja-kokeet","title":"Arvostelu ja kokeet"}}},{"node":{"id":"e78c9ef5-d275-5bf5-a509-1b9e4c75d71d","frontmatter":{"path":"/ilmoittautuminen","title":"Ilmoittautuminen"}}},{"node":{"id":"76068d63-4a30-5f9e-9efd-ed49edc98b6a","frontmatter":{"path":"/","title":"Tietoa kurssista"}}},{"node":{"id":"61df2549-c6f5-5c67-8b7f-8e9b179914c7","frontmatter":{"path":"/projekti","title":"Projekti"}}},{"node":{"id":"e771e805-db54-5575-a454-bd4c2716760b","frontmatter":{"path":"/osaamistavoitteet","title":"Osaamistavoitteet"}}},{"node":{"id":"5382499e-39f1-5cd3-b8dd-db9394113dd6","frontmatter":{"path":"/tukivaylat","title":"Tukiväylät"}}},{"node":{"id":"da046513-cc80-52ea-982b-6ba29eb36c6f","frontmatter":{"path":"/usein-kysytyt-kysymykset","title":"Usein kysytyt kysymykset"}}},{"node":{"id":"079e1fa2-0d02-5126-86d9-476aff42030b","frontmatter":{"path":"/ekstra/ajan-kasittely-tietokannassa","title":"Ajan käsittely tietokannassa"}}},{"node":{"id":"1af05bdb-9079-516d-be98-e23b12502041","frontmatter":{"path":"/ekstra/tietokantamigraatiot","title":"Tietokantamigraatiot"}}},{"node":{"id":"249178b9-973e-51fb-9b2e-6f9ce2dd2caa","frontmatter":{"path":"/osa-1/1-internetin-perusosat","title":"Internetin perusosat"}}},{"node":{"id":"d3789e1a-41d9-5c85-91ca-f0409e886900","frontmatter":{"path":"/osa-1/2-web-palvelimen-toiminta","title":"Web-palvelimen toiminta"}}},{"node":{"id":"5713905a-c5d4-5ecd-a8ea-115c942d7074","frontmatter":{"path":"/osa-1/3-spring-sovelluskehys","title":"Spring-sovelluskehys"}}},{"node":{"id":"466c1a97-6994-5173-bb91-61d05a30526b","frontmatter":{"path":"/osa-1/4-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"17d35c69-fc92-51be-bc33-4fc9ae222cde","frontmatter":{"path":"/osa-1","title":"Osa 1"}}},{"node":{"id":"3a940cd3-4bbf-51fd-ac1c-41aa09ff32d5","frontmatter":{"path":"/osa-2/1-nakymat-ja-data","title":"Näkymät ja data"}}},{"node":{"id":"bf989dd9-3412-5c74-884a-da6bb6aaac93","frontmatter":{"path":"/osa-2/2-tiedon-lahettaminen-palvelimelle","title":"Tiedon lähettäminen palvelimelle"}}},{"node":{"id":"e291213c-4b28-5f9d-b2e1-54f7d4dbe816","frontmatter":{"path":"/osa-2/3-tietokantojen-kasittely","title":"Tietokantojen käsittely ohjelmallisesti"}}},{"node":{"id":"30ad81c1-8b76-597c-9c62-751757da310b","frontmatter":{"path":"/osa-2/4-polkumuuttujat","title":"Polkumuuttujat"}}},{"node":{"id":"89a245a1-75c1-54b3-a601-672bbd9ec262","frontmatter":{"path":"/osa-2/5-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"cbe2bc5a-cc26-5910-9f4d-b044ec47abd3","frontmatter":{"path":"/osa-2","title":"Osa 2"}}},{"node":{"id":"b7817525-1953-521b-9e58-8a26d3665534","frontmatter":{"path":"/osa-3/1-useampi-tietokantataulu","title":"Useampi tietokantataulu ja taulujen väliset viitteet"}}},{"node":{"id":"6b7162fe-46bd-56fa-a8d2-41b0781f1c23","frontmatter":{"path":"/osa-3/2-tietokantatransaktiot","title":"Tietokantatransaktiot"}}},{"node":{"id":"7fcb1b86-738d-543a-a2bb-56119be2850c","frontmatter":{"path":"/osa-3/3-n-plus-1-kyselyn-ongelma","title":"N+1 kyselyn ongelma"}}},{"node":{"id":"c15b1320-b951-59b3-86b4-b647e04a54b8","frontmatter":{"path":"/osa-3/4-tulosten-rajaaminen-ja-jarjestaminen","title":"Tietokantakyselyiden tulosten rajaaminen ja järjestäminen"}}},{"node":{"id":"0ea05616-b6f5-54e2-8045-4a86c7c0b197","frontmatter":{"path":"/osa-3/5-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"8eff6b69-a4e1-5bfb-8d86-f93e7eef7978","frontmatter":{"path":"/osa-3","title":"Osa 3"}}},{"node":{"id":"22ccbbfe-8a60-5d30-a898-e2da567da345","frontmatter":{"path":"/osa-4/1-mediatyyppi-ja-tiedostojen-kasittely","title":"Mediatyyppi ja tiedostojen käsittely"}}},{"node":{"id":"cfcd1e2d-d678-502f-bc30-5ce24a9a29cd","frontmatter":{"path":"/osa-4/2-ohjelmistokehitysprosessi","title":"Muutama sana ohjelmistokehityksestä"}}},{"node":{"id":"2159f129-bc50-5474-97a7-e67d45a13742","frontmatter":{"path":"/osa-4/3-sovelluksen-rakenne","title":"Sovelluksen rakenne"}}},{"node":{"id":"382343a9-8806-5fc7-8c06-2cc69689b180","frontmatter":{"path":"/osa-4/4-konfiguraatioprofiilit","title":"Konfiguraatioprofiilit"}}},{"node":{"id":"708d8201-7107-566a-a74f-4b56444dcd0b","frontmatter":{"path":"/osa-4/5-sovellusten-testaaminen","title":"Sovellusten testaaminen"}}},{"node":{"id":"db8df001-8629-5e13-be04-df87d1afc2b7","frontmatter":{"path":"/osa-4/6-sovelluksen-siirtaminen-pilvipalveluun","title":"Sovelluksen siirtäminen pilvipalveluun"}}},{"node":{"id":"89ca7162-20da-5868-a3eb-5c973045856b","frontmatter":{"path":"/osa-4/7-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"582a5c8b-beca-5122-a87a-f2cb9068d18a","frontmatter":{"path":"/osa-4","title":"Osa 4"}}},{"node":{"id":"67422910-7142-56bb-80a6-cbd73f7461d3","frontmatter":{"path":"/osa-5/1-http-protokollan-tilattomuus-ja-evasteet","title":"HTTP-protokollan tilattomuus ja evästeet"}}},{"node":{"id":"c65c7fed-73a9-537f-b5f1-3241761326e3","frontmatter":{"path":"/osa-5/2-autentikaatio-ja-autorisaatio","title":"Autentikaatio ja autorisaatio"}}},{"node":{"id":"0428fec4-6ca3-527b-855a-bb3397e65d8c","frontmatter":{"path":"/osa-5/3-nakymatason-ja-metoditason-autorisointi","title":"Näkymä- ja metoditason autorisointi"}}},{"node":{"id":"dd6b12f5-d1ee-54b2-af79-f6f6963f8336","frontmatter":{"path":"/osa-5/4-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"62ff299a-8fe5-58fc-a1f3-010a9ca8ff9d","frontmatter":{"path":"/osa-5","title":"Osa 5"}}},{"node":{"id":"e2bfad01-9334-5cdb-88d1-6509e74db429","frontmatter":{"path":"/osa-6/1-toistuvat-rakenteet-html-sivuilla","title":"Toistuvat rakenteet HTML-sivuilla"}}},{"node":{"id":"59b114a1-6e99-515f-861c-c344839f5f6b","frontmatter":{"path":"/osa-6/2-tyylitiedostot-ja-asettelu","title":"Tyylitiedostot ja sivun asettelun määrittely"}}},{"node":{"id":"3d0269f8-2809-565c-9284-f15ab30559a1","frontmatter":{"path":"/osa-6/3-syotteiden-validointi","title":"Syötteiden validointi"}}},{"node":{"id":"65746c76-9e0b-5c1e-8388-589c3d895db8","frontmatter":{"path":"/osa-6/4-rajapinnat-ja-rest","title":"Rajapinnat ja REST"}}},{"node":{"id":"6c0caa0b-e5f4-5818-b2d0-602f51175ffe","frontmatter":{"path":"/osa-6/5-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"87285c75-6058-5ed6-af3a-67835f2e9758","frontmatter":{"path":"/osa-6","title":"Osa 6"}}},{"node":{"id":"1edfd6c7-3880-5e94-b639-6c9d80ff7d14","frontmatter":{"path":"/osa-7/1-selainohjelmistot-ja-javascript","title":"Selainohjelmistot ja JavaScript"}}},{"node":{"id":"7c1c61e3-b3e5-5b18-88ab-571ea9f529b8","frontmatter":{"path":"/osa-7/2-tietoturva","title":"Muutama sana tietoturvasta"}}},{"node":{"id":"457aeff4-3970-5308-88c0-cbadc4c4da14","frontmatter":{"path":"/osa-7/3-sovellusten-skaalautuminen","title":"Isommille käyttäjämäärille skaalautuvat sovellukset"}}},{"node":{"id":"40649dd6-c843-59b5-b08b-2ffe5344119c","frontmatter":{"path":"/osa-7/4-reaktiivinen-ohjelmointi","title":"Reaktiivinen ohjelmointi"}}},{"node":{"id":"a1a0b842-6a0f-5dc5-835a-7b47ef681fe4","frontmatter":{"path":"/osa-7/5-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"a7e70d0e-5b2d-52f5-a5e8-5b9e6fd90aa8","frontmatter":{"path":"/osa-7","title":"Osa 7"}}},{"node":{"id":"8d82aaf9-de05-5ae7-a886-7e21e8781ae3","frontmatter":{"path":"/osa-x/x-johdanto","title":"Johdanto"}}}]}},"pageContext":{}},"staticQueryHashes":["2929037737","994120085"]}